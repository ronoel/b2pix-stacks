<div class="payment-container">
  <!-- Timer Warning - Compact -->
  <div class="timer-warning-compact">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
      <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <span class="timer-label-compact">Tempo restante:</span>
    <div class="timer-display-compact">{{ formattedTime }}</div>
  </div>

  <div class="payment-card">
    <!-- Amount Section - Compact -->
    <div class="amount-section-compact">
      <div class="amount-row-compact">
        <div class="amount-item-compact">
          <span class="amount-label-compact">Você pagará</span>
          <div class="payment-amount-compact">R$ {{ fiatAmount }}</div>
        </div>
        <div class="amount-item-compact">
          <span class="amount-label-compact">Receberá</span>
          <div class="btc-amount-container">
            <span class="btc-approximation-symbol">~</span>
            <div class="btc-amount-compact">{{ btcAmount }} BTC</div>
            <svg class="btc-info-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" title="Valor aproximado, pode variar conforme taxa de câmbio">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
              <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
        </div>
      </div>
    </div>

    <!-- PIX Copia e Cola Section -->
    <app-pix-copia-cola
      [pixKey]="pixKey"
      [amount]="fiatAmountValue"
      [sellerName]="sellerName"
      [sellerCity]="sellerCity"
      labelNumber="1"
    ></app-pix-copia-cola>

    <!-- Transaction ID Section - HIGHLIGHTED -->
    <div class="transaction-id-section-highlight">
      <div class="section-header-highlight">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
        </svg>
        <label class="txid-label-highlight">2. ID da Transação PIX</label>
      </div>

      <p class="instruction-text-compact">Após realizar o pagamento, informe os <strong>3 últimos caracteres</strong> do ID da transação do comprovante PIX.</p>

      <div class="form-group-compact">
        <input
          type="text"
          id="transactionId"
          maxlength="3"
          [value]="transactionId()"
          (input)="onTransactionIdChange($any($event.target).value)"
          [disabled]="noTransactionId()"
          class="transaction-input-highlight"
          [class.disabled]="noTransactionId()"
          placeholder="Ex: 9Z7"
          autocomplete="off"
        >
        @if (transactionId().length > 0 && !canConfirm && !noTransactionId()) {
          <div class="error-message-compact">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
              <path d="M15 9L9 15M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Informe exatamente 3 caracteres
          </div>
        }
      </div>

      <div class="checkbox-group-compact">
        <label class="checkbox-label-compact">
          <input
            type="checkbox"
            [checked]="noTransactionId()"
            (change)="onNoTransactionIdChange($any($event.target).checked)"
          >
          <span class="checkbox-custom"></span>
          <span class="checkbox-text-compact">Não encontrei o ID da transação</span>
        </label>
        @if (noTransactionId()) {
          <div class="warning-message-compact">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
              <path d="M12 9v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Isso pode atrasar a validação</span>
          </div>
        }
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button type="button" class="btn btn-outline cancel-btn" (click)="cancel.emit()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Cancelar Compra
      </button>
      <button
        type="button"
        class="btn btn-success btn-lg confirm-btn"
        [disabled]="!canConfirm"
        (click)="confirm.emit()"
      >
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
        </svg>
        Confirmar Pagamento
      </button>
    </div>
  </div>
</div>

