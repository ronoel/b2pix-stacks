<div class="dispute-management">
  <div class="container">
    <!-- Header -->
    <div class="page-header">
      <button class="btn btn-ghost" (click)="goBack()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Voltar
      </button>
      <div class="header-content">
        <h1 class="page-title">Análise de Ordens</h1>
        <p class="page-subtitle">Analise e resolva ordens pendentes de verificação</p>
      </div>
    </div>

    @if (loading()) {
      <!-- Loading State -->
      <div class="loading-section">
        <div class="loading-spinner"></div>
        <p>Carregando ordens...</p>
      </div>
    } @else if (error()) {
      <!-- Error State -->
      <div class="error-state">
        <div class="error-icon">
          <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2"/>
            <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <h2>Erro ao carregar ordens</h2>
        <p>{{ error() }}</p>
        <button class="retry-button" (click)="loadAnalyzingOrders()">Tentar Novamente</button>
      </div>
    } @else if (analyzingOrders().length === 0) {
      <!-- Empty State -->
      <div class="empty-state">
        <div class="empty-icon">
          <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
            <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <h2>Nenhuma ordem em análise</h2>
        <p>Não há ordens pendentes de análise no momento.</p>
      </div>
    } @else {
      <!-- Disputes List -->
      <div class="disputes-list">
        <div class="disputes-header">
          <h2>Ordens em Análise ({{ analyzingOrders().length }})</h2>
        </div>

        <div class="dispute-cards">
          @for (buy of analyzingOrders(); track buy.id) {
            <div class="dispute-card" (click)="viewOrderDetails(buy.id)">
              <div class="dispute-header">
                <div class="dispute-id">
                  <strong>ID:</strong> {{ buy.id }}
                </div>
                <div class="dispute-status">
                  <span class="status-badge dispute">{{ getStatusText(buy.status) }}</span>
                </div>
              </div>

              <div class="dispute-details">
                <div class="detail-row">
                  <span class="label">Valor:</span>
                  <span class="value">R$ {{ formatCurrency(buy.buy_value) }}</span>
                </div>
                <div class="detail-row">
                  <span class="label">Bitcoin:</span>
                  <span class="value">{{ formatBitcoin(buy.amount) }} BTC</span>
                </div>
                <div class="detail-row">
                  <span class="label">Comprador:</span>
                  <span class="value">{{ formatAddress(buy.address_buy) }}</span>
                </div>
                <div class="detail-row">
                  <span class="label">Data da Criação:</span>
                  <span class="value">{{ formatDate(buy.created_at) }}</span>
                </div>
              </div>

              <div class="dispute-actions">
                <div class="action-arrow">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    }
  </div>
</div>
